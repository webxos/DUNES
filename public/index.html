<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vial MCP Controller</title>
    <style>
        body {
            background: black;
            color: #00ff00;
            font-family: monospace;
            margin: 0;
            padding: 20px;
        }
        #console-output {
            height: 200px;
            overflow-y: scroll;
            border: 1px solid #00ff00;
            padding: 10px;
            margin-bottom: 10px;
        }
        #console-input {
            background: #111;
            color: #00ff00;
            border: 1px solid #00ff00;
            width: 100%;
            padding: 5px;
        }
        button {
            background: #00ff00;
            color: black;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            margin: 5px;
        }
        #balance-reputation {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Vial MCP Controller</h1>
    <div id="console-output">Vial MCP Controller initialized. Use /help for commands.</div>
    <div id="balance-reputation">$WEBXOS Balance: 0.0000 | Reputation: 0</div>
    <input id="console-input" type="text" placeholder="Enter command (e.g., /import wallet.md)">
    <div>
        <button onclick="executeCommand()">Execute</button>
        <button onclick="importWallet()">Import</button>
        <button onclick="exportWallet()">Export</button>
        <button onclick="gitCommand()">Git Commit</button>
        <button onclick="showHelp()">Help</button>
    </div>
    <script>
        async function executeCommand() {
            const input = document.getElementById('console-input').value;
            const output = document.getElementById('console-output');
            if (input.startsWith('/import')) {
                importWallet(input.split(' ')[1]);
            } else if (input.startsWith('/git')) {
                gitCommand(input.split(' ').slice(1).join(' '));
            } else {
                const response = await fetch('/api/console', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ command: input })
                });
                const data = await response.json();
                output.innerHTML += `<p>${data.result}</p>`;
            }
        }

        async function importWallet(file = null) {
            const output = document.getElementById('console-output');
            const fileInput = file || prompt('Enter .md file path');
            const response = await fetch('/api/wallet/import', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ file: fileInput })
            });
            const data = await response.json();
            output.innerHTML += `<p>Imported wallet: ${data.network_id}</p>`;
            updateBalanceReputation(data);
        }

        async function exportWallet() {
            const output = document.getElementById('console-output');
            const response = await fetch('/api/wallet/export', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + localStorage.getItem('token') }
            });
            const data = await response.json();
            output.innerHTML += `<p>Exported wallet: ${data.file}</p>`;
        }

        async function gitCommand(command = 'commit -m "Update"') {
            const output = document.getElementById('console-output');
            const response = await fetch('/api/git', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + localStorage.getItem('token') },
                body: JSON.stringify({ command })
            });
            const data = await response.json();
            output.innerHTML += `<p>Git: ${data.result}</p>`;
        }

        function updateBalanceReputation(data) {
            const balanceReputation = document.getElementById('balance-reputation');
            balanceReputation.innerHTML = `$WEBXOS Balance: ${data.balance} | Reputation: ${data.reputation}`;
        }

        function showHelp() {
            const output = document.getElementById('console-output');
            output.innerHTML += `<p>Commands: /import <file>, /git <command>, /help</p>`;
        }
    </script>
</body>
</html>
